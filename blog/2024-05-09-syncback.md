---
slug: syncback-announcement
title: Announcing Syncback
authors: Dekkonot
---

I am here to announce a new feature for Rojo that we are calling 'syncback'!

Syncback is designed to solve the longstanding problem of converting a Roblox file (like a `.rbxl`) into a Rojo project. It replaces [`rbxlx-to-rojo`][rbxlx-to-rojo] in this respect. Beyond that though, syncback is meant to assist with "fully managed" Rojo by automating the process of taking things out of a place file and placing them into Studio.

This blog will go into what it does, how to use it, and a quick overview of how it works.

[rbxlx-to-rojo]: https://github.com/rojo-rbx/rbxlx-to-rojo

## What Does It Do?

As mentioned previously, syncback converts Roblox files into a Rojo project. What this means in practice is that syncback will take a Roblox file, iterate through it, and then create a bunch of files that will recreate that Roblox project when synced with Rojo. Unlike `rbxlx-to-rojo`, syncback covers all Instances in a file. This means that if syncback is run over a place file, you should be able to use `rojo build` on the project and get something that is identical.

Syncback also does something that's new for Rojo: it handles 'reference' properties like `Model.PrimaryPart`, even across files. Prior to work starting on syncback, this was something that we'd mostly ignored. Reference properties worked within `.rbxm` and `.rbxmx` files, but doing it across files was simply not something we actually supported. So you couldn't, as an example, have a `.model.json` file that pointed to another `.model.json` file.

This has changed now though, and reference properties are supported. This is a feature that's separate from syncback, so it won't be covered here in full. The important part is that syncback will preserve reference properties when running.

## How Do I Use It?

Perhaps counterintuitively, syncback requires a `.project.json` file. This is actually how you control it! When iterating through a file, it'll only handle Instances that are descendants of an Instance defined by the project. This means that in order to e.g. include `Workspace` in syncback, there needs to be a node in your project file representing `Workspace`.

To give a proper example, let's imagine you have a project file like this:

```json
{
    "name": "example project",
    "tree": {
        "$className": "DataModel",
        "ReplicatedStorage": {
            "$path": "src/ReplicatedStorage"
        }
    }
}
```

If you were to run syncback over top of that project, only things that were a descendant of `ReplicatedStorage` would be included. Additionally, since `$path` points to a directory, syncback would put children of `ReplicatedStorage` into that directory.

To run syncback, simply use `rojo syncback --input path/to/file.rbxl project_path` in your terminal, where `--input` is the path to the Roblox file you want to convert and `project_path` is a path a project you're using as the output. If the folder you're in includes a `default.project.json`, you don't need to provide `project_path`.

If you need help with this, remember to try running `rojo help syncback` in your terminal or simply ask someone for help.

## What Are The Limitations?

Syncback has overcome some technical limits Rojo had, but it has its own set of limitations. They are, in no particular order:

- `.toml` and `.json` files do not syncback (note: this does **not** include `.model.json`, `.project.json`, or `.meta.json` files)
- Non-scriptable properties (e.g. [`Lighting.Technology`][lighting.technology]) may appear in syncback, but cannot be written when using `rojo serve`
- Instances that are a child of an Instance created by a Project file must have unique names
- Instance names must be valid UTF-8 and not contain any names or characters forbidden on the major platforms that Rojo runs on.

The reason `.toml` and `.json` files cannot be synced back is very simple: Rojo does not have a Luau parser built into it. Even if it did, it would be difficult to convert Luau tables into JSON or TOML, since things like invalid values (e.g. Roblox datatypes) would have to be handled.

The others are practical limits: Rojo cannot sync properties that Roblox doesn't let us write via the Roblox Studio plugin. Additionally, since Rojo is a cross platform tool, we respect the limitations of MacOS, Windows, and (most) Linux distros when it comes to file names. This means that characters like `/` aren't allowed in Instance names, since they'd have to become files with that name. 

[lighting.technology]: https://create.roblox.com/docs/reference/engine/classes/Lighting#Technology

## How Does It Work?

This isn't a technical blog, so this will be a very brief overview of how syncback works. If you don't care about implementation details, you can skip this part.

At its core, there are two technical challenges with syncback:

1. Calculating the differences between a Rojo project and a Roblox file
2. Syncing Roblox instances back to the file system

To get into it, we'll cover each one in sequence.

### Calculating Differences

The reason you need to calculate the difference between your Rojo project and a Roblox file may not be obvious at first. After all, when you're running syncback, it makes sense to just write everything back to the file system. However, part of the design of syncback is that some people will be using it quite often. As a result, it's important to minimize the work done.

The method for calculating the difference (diffing) the project and Roblox file is easy to explain, luckily. Each Instance in both trees is hashed, incorporating the Instance's classname, all of its properties *and* the hashes of its children. Then, the hashes for Instances are compared between the Rojo project and the Roblox file. Due to the way the hashes are constructed, if an Instance's hash matches, the entire subtree under that Instance is guaranteed to be identical. This allows large swathes of the Roblox file to be skipped during syncback.

In practice, this mostly ends up just minimizing the amount of files written to the file system if you're just running syncback infrequently, since syncback itself is fairly fast. However, for multiple runs in rapid succession, it results in *zero* files being written to the file system. This is very nice.

### Syncing Back to the File System

In Rojo, there is a concept called `Middleware`. You may know them from sync rules, which were also added in 7.5; they're things like `JsonModel` and `ModuleScript`, which take files and turn them into Instances. During the development of syncback, it became necessary for each middleware to know how to do the opposite: take an Instance and turn it into a file.

This is where the meat of syncback is. Each Middleware (except `.toml` and `.json` files) is now capable of converting Roblox Instances into a file. This turned out to be more work than expected for some cases, particular `project.json` files, but after a long time, it's done. This infastructure has several consequences. The first and formost is that Rojo can now actually run syncback and that it can use the existing file for nearly everything when one exists. However, this has a fun and exciting consequence as well: two way sync is within sight. The hard part of taking Instances and putting them on the file system is done, so work on it can focus on practical implementation details.